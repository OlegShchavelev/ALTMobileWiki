# Документация

В рамках проекта ALT Mobile проводится работа по поддержке мобильных устройств на базе проекта Sisyphus.

## Целеполагание

### Базовая система на СПО

Фундаментальной целью проекта является построение операционной системы мобильного устройства (телефон, планшет) целиком и полностью на свободном ПО. Мы считаем, что это единственный способ, при котором пользователь может получить полноценный контроль над своим устройством, а не наоборот; это работающий способ контроля над своими данными и путь к цифровому суверенитету.

В нашей системе загрузчик, ядро, базовые компоненты операционной системы (пользовательская оболочка, ядро, браузер, основные пользовательские приложения) являются СПО — таким образом, устройством можно пользоваться из коробки без проприетарного ПО на основном системном процессоре.

Исключение делается только для низкоуровневых компонент, работающих на обособленных чипах: например, прошивки wifi, bluetooth и прочих периферийных устройств. Но и здесь мы отдаём предпочтение свободным прошивкам при их наличии, например, [`pinephone_modem_sdk`](https://github.com/the-modem-distro/pinephone_modem_sdk) для модемов EG25-G.

**А как же проприетарное ПО?**

Его вполне можно использовать при желании и наличии совместимости, но его использование не должно быть обязательным для нормального функционирования устройства. Безусловно, это может негативно сказаться на безопасности и приватности.

### Полноценный Linux на телефоне

Наша цель — предоставить на мобильном устройстве полноценный Линукс, точно тот же Альт, что есть и на других устройствах, но с оболочкой и приложениями, поддерживающими мобильный интерфейс. Это не какая-то отдельная операционная система, не клон Android, а самый обычный Альт Линукс.

## Поддерживаемое оборудование

Построение базовой системы на СПО позволяет легко добавить поддержку нового оборудования при условии наличия `devicetree` и исходников драйверов устройств.

На текущий момент поддерживается ниже перечисленное оборудование:

#### Rockchip

Поддерживается оборудование на базе СнК Rockchip aarch64, для которых есть `devicetree` и драйвера для периферии. В частности:

##### `rk3399`

Игровая приставка **Anbernic RG552**

##### `rk3399s`

Телефон **PinePhone Pro**

##### `rk3566`

Планшет **PineTab2**, игровые приставки **ANBERNIC RG ARC-D/RG ARC-S**, **Anbernic RG353M, P, V**

#### Скиф

Специалистами Элвис обеспечена работа на системе на кристалле Скиф. Поддержка реализована в качестве производной ALT Mobile, использует ядро, отсутствующее в Сизифе.

#### x86_64

Планшеты **RCA Cambio w101v2** и **Lenovo MIIX 320-10ICR**

### Полный перечень поддерживаемого оборудования

|        Модель         |  Совместимость  | Бренд  |                ОС                 |                      SoC                      | Накопитель                          |         RAM         |                                             Экран                                              |                                                             Примечание                                                             |
| :-------------------: | :-------------: | :----: | :-------------------------------: | :-------------------------------------------: | ----------------------------------- | :-----------------: | :--------------------------------------------------------------------------------------------: | :--------------------------------------------------------------------------------------------------------------------------------: |
|     Chuwi Hi8 Pro     | :orange_circle: | Chuwi  |        Windows 8, Android         | Intel® Atom™ Z8300, 4 ядра на 1,44–1,84 ГГц | 32 ГБ eMMC, microSD (до 64 ГБ)      |      DDR3L 2GB      |                           8", 1200x1920, встроенная графика Intel HD                           |                                                         Не работает камера                                                         |
| Chuwi HiBook (CWI514) | :orange_circle: | Chuwi  |        Windows 8, Android         |   Intel® Atom™ Z8300, 4 ядра на 1,84 ГГц    | 64 ГБ eMMC, microSD (до 64 ГБ)      |      DDR3L 4GB      |                         10,1", 1200x1920, встроенная графика Intel HD                          |                                        Не работает камера; Сбита калибровка поворота экрана                                        |
| Lenovo MiiX 320-10ICR | :orange_circle: | Lenovo |             Windows 8             | Intel Atom x5-Z8350, 4 ядра на 1,44–1,92 ГГц  | 32 ГБ eMMC, microSD (до 128 ГБ)     |      DDR3L 2GB      | 10,1" (256mm) FullHD (1920x1200), матрица IPS, 16:10, встроенная графика Intel HD Graphics 400 |                                                         Не работают камеры                                                         |
|      MIG T8X x86      | :green_circle:  |  MIG   |      Astra Linux, Windows 10      |    Intel Celeron N5100, 4 ядра, до 2,8 ГГц    | 64 ГБ eMMC, microSD (до 512 ГБ)     |         4GB         |      8", 1200x1920, ударопрочный, с повышенной читаемостью на солнце (светимость 550 нит)      |                                                     Не работает вспышка и NFC                                                      |
|       MIG LT11i       | :orange_circle: |  MIG   |         Astra Linux, JeOS         |                  NXP IMX8MM                   | 64 ГБ eMMC, SD (до 512 ГБ)          |         4GB         |                                     10.95", IPS, 2000x1200                                     | Проприетарный загрузчик; Не работают камеры; Проблемы с инициализацией Bluetooth; Не работает модем; Страдает аппаратное ускорение |
|       PinePhone       | :green_circle:  | PINE64 |   postmarketOS, Manjaro, Ubuntu   |                 Allwinner A64                 | 16/32 ГБ eMMC, microSD (до 512 ГБ)  |    2-3 GB LPDDR3    |                                   5,95", LCD, 1440×720, 18:9                                   |                                                         Не работают камеры                                                         |
|     PinePhone Pro     | :green_circle:  | PINE64 |   postmarketOS, Manjaro, Ubuntu   |               Rockchip RK3399s                | 128 ГБ eMMC, microSD (SDXC до 2 ТБ) | 4GB LPDDR4 @ 800MHz |                                   6", 1440x720, In-Cell IPS                                    |                                                         Не работают камеры                                                         |
|       PineTab2        | :orange_circle: | PINE64 | postmarketOS, Manjaro, Arch Linux |                Rockchip RK3666                | 128 ГБ eMMC, microSD (до 2 ТБ)      |  8GB LPDDR4 SDRAM   |                               10,1" (256mm), HD (1280x800), IPS                                |                                                   Не работают камеры и Bluetooth                                                   |
|  RCA Cambio W101 V2   | :orange_circle: |  RCA   |             Windows 8             |   Intel® Atom™ Z3735F, 4 ядра на 1.33 ГГц   | 32GB eMMC, microSD (до 64 ГБ)       |      DDR3L 2GB      |                          10,1", 1280x800, встроенная графика Intel HD                          |                                        Не работает камера; Сбита калибровка поворота экрана                                        |

::: info Примечание
Устройства на базе SoC Intel® Atom™

В данной таблице приведены не все вариации устройств, а только прошедшие тестирование

Условные обозначения:

- :green_circle: — полностью работоспособна
- :yellow_circle: — имеются небольшие глюки
- :orange_circle: — требуется серьёзная доработка (драйвер / модуль ядра / прошивка)
- :red_circle: — имеются фатальные дефекты на аппаратном уровне, требуется доводка напильником

:::

### Дисковые образы

Есть сборки образов для архитектур `x86_64`, `aarch64`, `riscv`. Их можно как запускать на оборудовании, поддерживаемом ядром `def`, так и с помощью QEMU.

Они вполне достаточны для работ над мобильным интерфейсом, адаптацией приложений. При подключении внешнего модема, поддерживаемого ModemManager (в идеале Quectel EG25-G) возможна и работа с мобильными сетями и сопутствующей телефонией).

## Образы

Образы для aarch64 оборудования и qemu для поддерживаемых архитектур доступны на ftp для [sisyphus](https://beta.altlinux.org/mobile/sisyphus/latest/) и [p11](https://beta.altlinux.org/mobile/p11/latest/).

Инструмент сборки образов `mkimage-profiles` доступен в [git](https://git.altlinux.org/people/antohami/packages/mkimage-profiles.git).

### Сборка

Для самостоятельной сборки образов следует клонировать вышеуказанный `git` и перейти в ветку `next`.

Затем следует на целевой архитектуре собрать соответствующую цель сборки. Например, для сборки образа для PinePhone Pro нужно на aarch64 хосте выполнить:

```shell
make vm/pinephone-phosh.img ARCH=aarch64 DEBUG=1
```

:::info
Кросс-компиляция образов не поддерживается.
:::

Для изменения состава пакетов см. pkg.in/lists/mobile. Параметры и сценарий сборки настраиваются в conf.d/phone.mk. Детальная информация по работе с инструментом сборки содержится [в документации `mkimage-profiles`](https://www.altlinux.org/Mkimage-profiles).

## Установка

Подробнее про установку ALT Mobile на поддерживаемые устройства и виртуальные машины можно прочитать в статье ALT Mobile Wiki:

- [Установка ALT Mobile на телефон PinePhone Pro](/instalations/mobile-devices/)
- [Установка ALT Mobile на портативные приставки Anbernic](/instalations/portable-game-consoles/)
- [Установка ALT Mobile на планшеты-трансформеры](/instalations/tablets/)
- [ALT Mobile Виртуальная машина](/instalations/virtual-machine/)
- [Полнодисковое шифрование](/instalations/luks/)

## Использование

На данный момент использование предназначено только в целях разработки, повседневное применение как основного смартфона пока что не рекомендуется.

Логины по умолчанию: `root` (пароль: `altlinux`), `altlinux` (пароль: `271828`).

### Обновление

Обновлять следует методом, который гарантирует работоспособность среды обновления в процессе обновления. Например, если запустить обновление в GUI консоли Phosh и в процессе обновления будет перезагружен Phosh, обновление прервётся и система может оказаться неработоспособной.

Поддерживаемые способы:

**`screen`**

Стандартный `apt-get update && apt-get dist-upgrade -a` рекомендуется выполнять в менеджерах терминалов `screen` или `tmux`, гарантирующих продолжение работы при прерывании родительских процессов. Рекомендуется использовать `ssh` или последовательный порт для контроля над процессом.

В таком сценарии пользователь сам должен перезагрузить устройство по необходимости (например, при обновлении ядра).

**`packagekit`**

PackageKit работает путём скачивания обновлений, перезагрузки и установки всех пакетов в контролируемом окружении и последующей перезагрузки для полноценной работы. Интерфейсом для работы с `packagekit` является Gnome Software ("магазин" приложений из Сизифа).

## Статус ПО

Доступно всё программное обеспечение из репозитория Сизиф. Детальная информация [на отдельной странице](/software/).

## TODO

Перечень открытых задач достаточно большой, поэтому его можно найти [на отдельной странице](/todo/).

## Известные проблемы

**Полностью разряженная батарея**

При полностью разряженной батарее телефон может не загрузиться даже при подключении к сети. Эта проблема решена с свежих версиях `tow-boot`, необходимо обновиться. Если нет батарея уже полностью разряжена и нет возможности обновить `tow-boot`, нужно зарядить её на внешнем устройстве, можно подать питание `5V` ненадолго.

**Система перестала загружаться в ходе обновления**

Обновляться следует рекомендуемыми способами. Если система уже сломана, следует записать новый образ, перед этим необходимо сохранить все важные пользовательские данные (в первую очередь `~/.local` и `~./config`)
